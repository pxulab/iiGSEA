% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/iiGSEA.R
\name{iiGSEA}
\alias{iiGSEA}
\title{iiGSEA: Iterative Gene Set Enrichment Analysis for scRNA-seq}
\usage{
iiGSEA(
  normalized_data,
  gs,
  imputed_data = NA,
  iteration = TRUE,
  n_cutoff = 50,
  start = 0.01,
  end = 0.6,
  magic_seed = 123,
  jobs = 20
)
}
\arguments{
\item{normalized_data}{A matrix of normalized expression data (genes x cells).}

\item{gs}{A list of gene sets for the initial analysis.}

\item{imputed_data}{Optional matrix of imputed expression data (genes x cells); if not provided, MAGIC imputation is applied.}

\item{iteration}{Logical, whether iterative refinement of gene sets should be performed.}

\item{n_cutoff}{Integer, the maximum number of top markers to refine.}

\item{start}{Numeric, the start position for defining significant cells.}

\item{end}{Numeric, the end position for defining significant cells.}

\item{magic_seed}{Integer, a seed for reproducibility of MAGIC imputation.}

\item{jobs}{Integer, the number of jobs/threads for parallel processing.}
}
\value{
A list containing:
        - EnrichmentScores: The final enrichment scores for each cell and gene set.
        - Cutoff: Calculated cutoffs for significant cells.
        - Markers: A data frame of differentially expressed genes if iteration is TRUE.
}
\description{
This function performs an iterative gene set enrichment analysis on single-cell RNA-seq data.
The analysis starts with an initial imputation (optional) followed by single-sample GSEA (ssGSEA),
and subsequently refines gene sets by identifying differentially expressed genes (DEGs) in significant cells.
}
\examples{
# Example usage
iiGSEA(normalized_data = matrix(rnorm(1000), nrow=100, ncol=10), gs = list(GeneSet1 = c("GeneA", "GeneB")))
}
